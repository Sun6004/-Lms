<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="kr.or.hku.classroom.mapper.AttendanceMapper">

		<!-- 해당 과목 수강하는 학생 리스트 가져오기 -->
	 	<select id="getStdList" resultType="attendanceVO" parameterType="string">
	 	/*kr.or.hku.classroom.mapper.AttendanceMapper.getStdList */
			SELECT
			  s.std_no
			, s.std_nm
			, d.dept_nm
			FROM 
			  course_regist cr
			  JOIN student s ON cr.std_no = s.std_no
			  JOIN department d ON s.dept_cd = d.dept_cd
			  JOIN lecture_aply l ON cr.lecap_no = l.lecap_no
			WHERE
			  l.lecap_no = #{lecapNo}
		</select>
 		
 		<!-- 학생 출석 여부 리스트 가져오기  -->
 		<select id="getStdAttendanceList" parameterType="attendanceVO" resultType="attendanceVO">
 		/*kr.or.hku.classroom.mapper.AttendanceMapper.getStdAttendanceList */
 			select 
 				atdc_no,
 				atdc_yn_cd,
 				atdc_week
 			FROM attendance 
 			WHERE lecap_no = #{lecapNo}
 			AND std_no = #{stdNo}
 		</select>
 		
 		<!-- 출석 변경  -->
		<update id="updateAttendance" parameterType="attendanceVO">
		/*kr.or.hku.classroom.mapper.AttendanceMapper.updateAttendance */
			UPDATE attendance 
	        SET                 
	        	<if test='atdcYnCd == "Y"'>
		           atdc_yn_cd = 'N' 
	        	</if>                 
	        	<if test='atdcYnCd == "N" or atdcYnCd == "x"'>
		           atdc_yn_cd = 'Y' 
	        	</if>                 
	        WHERE atdc_no = #{atdcNo} 
		</update>
		
		
 </mapper>